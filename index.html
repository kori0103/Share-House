<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì´ìƒí•œ í•˜ìš°ìŠ¤ë©”ì´íŠ¸</title>

  <style>
    :root { font-family: system-ui, -apple-system, "Noto Sans KR", sans-serif; }
    body { margin: 0; background: #0b0d12; color: #e8e9ef; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; }
    .card { background: #141826; border: 1px solid #222842; border-radius: 16px; padding: 16px; box-shadow: 0 8px 24px rgba(0,0,0,.35); }
    .title { font-size: 18px; font-weight: 800; margin: 0 0 8px; }
    .meta { display: flex; gap: 10px; flex-wrap: wrap; font-size: 13px; opacity: .9; margin-top: 6px; }
    .pill { background: #1b2140; border: 1px solid #2a3470; padding: 6px 10px; border-radius: 999px; }
    .log { margin-top: 12px; line-height: 1.7; white-space: pre-wrap; }
    .btns { display: grid; gap: 10px; margin-top: 14px; }
    button{
      border: 1px solid #2a3470; background: #1b2140; color: #e8e9ef;
      padding: 14px; border-radius: 14px; font-size: 16px;
      cursor: pointer; touch-action: manipulation;
      width: 100%;
    }
    button:active { transform: translateY(1px); }
    .row { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
    .ghost { background: transparent; border: 1px solid #2a3470; }
    .small { font-size: 13px; opacity: .85; margin-top: 10px; }
    .center { text-align: center; }
    .logo { width: 90%; max-width: 520px; margin: 22px auto 18px; display: block; border-radius: 16px; }
  </style>
</head>

<body>

  <!-- íƒ€ì´í‹€ í™”ë©´ -->
  <div id="title" class="wrap">
    <div class="card center">
      <img src="logo.png" class="logo" alt="ì´ìƒí•œ í•˜ìš°ìŠ¤ë©”ì´íŠ¸ ë¡œê³ ">
      <button id="btnStart">ì‹œì‘í•˜ê¸°</button>
      <div class="small">ğŸŒ¾ ì‹œê³¨ ì‰ì–´í•˜ìš°ìŠ¤ì—ì„œ ì¸ì™¸ë“¤ê³¼ í•¨ê»˜í•˜ëŠ” ì´ì•¼ê¸°</div>
    </div>
  </div>

  <!-- ê²Œì„ í™”ë©´ -->
  <div id="game" class="wrap" style="display:none;">
    <div class="card">
      <h1 class="title">ğŸŒ¾ ã€ˆì‹œê³¨ ì‰ì–´í•˜ìš°ìŠ¤: ì¸ì™¸ì™€ í•¨ê»˜ã€‰</h1>

      <div class="meta" id="meta"></div>
      <div class="log" id="log"></div>
      <div class="btns" id="choices"></div>

      <div class="row">
        <button class="ghost" id="btnSave">ì €ì¥</button>
        <button class="ghost" id="btnLoad">ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button class="ghost" id="btnRestart">ì²˜ìŒë¶€í„°</button>
      </div>

      <div class="small">ì €ì¥ì€ ì´ ê¸°ê¸° ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤(localStorage).</div>
    </div>
  </div>

  <script>
    // ====== ìƒíƒœ ======
    const STORAGE_KEY = "sharehouse_save_v1";

    const defaultFlags = () => ({
      met_alpha_deep: false,
      met_kai_deep: false,
      met_otori_deep: false,
      _morningStarted: false,
      _middayStarted: false,
      _eveningStarted: false,
      _nightStarted: false,
    });

    const state = {
      day: 1,
      slot: 0, // 0 ì•„ì¹¨, 1 ë‚®, 2 ì €ë…, 3 ë°¤
      affinity: { "ì•ŒíŒŒ": 0, "ì¹´ì´": 0, "ì˜¤í† ë¦¬": 0 },
      flags: defaultFlags(),
      log: [],
      awaitingChoice: null,
    };

    const TIME = ["ì•„ì¹¨", "ë‚®", "ì €ë…", "ë°¤"];
    const $ = (id) => document.getElementById(id);

    function narr(text){ state.log.push(text); }
    function say(name, text){ state.log.push(`${name}: ${text}`); }
    function addAffinity(who, delta){ state.affinity[who] = (state.affinity[who] ?? 0) + delta; }

    function setChoice(prompt, options){
      state.awaitingChoice = { prompt, options };
    }
    function clearChoices(){ state.awaitingChoice = null; }

    function render(){
      $("meta").innerHTML = `
        <div class="pill">ğŸ“… ${state.day}ì¼ì°¨</div>
        <div class="pill">â° ${TIME[state.slot] ?? "â€”"}</div>
        <div class="pill">ğŸ’¬ ì•ŒíŒŒ ${state.affinity["ì•ŒíŒŒ"]}</div>
        <div class="pill">ğŸ’¬ ì¹´ì´ ${state.affinity["ì¹´ì´"]}</div>
        <div class="pill">ğŸ’¬ ì˜¤í† ë¦¬ ${state.affinity["ì˜¤í† ë¦¬"]}</div>
      `;

      $("log").textContent = state.log.join("\n\n");

      const box = $("choices");
      box.innerHTML = "";

      if(state.awaitingChoice){
        const p = document.createElement("div");
        p.style.opacity = ".95";
        p.style.marginTop = "8px";
        p.textContent = state.awaitingChoice.prompt;
        box.appendChild(p);

        state.awaitingChoice.options.forEach((opt, i) => {
          const btn = document.createElement("button");
          btn.textContent = `${i+1}. ${opt.text}`;
          btn.onclick = () => {
            clearChoices();
            opt.run();
            autoSave();
            render();
          };
          box.appendChild(btn);
        });
      } else {
        const btn = document.createElement("button");
        btn.textContent = "ê³„ì†";
        btn.onclick = () => { advance(); autoSave(); render(); };
        box.appendChild(btn);
      }

      window.requestAnimationFrame(() => {
        window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
      });
    }

    function autoSave(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        day: state.day,
        slot: state.slot,
        affinity: state.affinity,
        flags: state.flags,
        log: state.log,
      }));
    }

    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return false;
      try{
        const data = JSON.parse(raw);
        state.day = data.day ?? 1;
        state.slot = data.slot ?? 0;
        state.affinity = data.affinity ?? { "ì•ŒíŒŒ":0, "ì¹´ì´":0, "ì˜¤í† ë¦¬":0 };
        state.flags = { ...defaultFlags(), ...(data.flags ?? {}) };
        state.log = data.log ?? [];
        state.awaitingChoice = null; // ì„ íƒì§€ëŠ” ì €ì¥í•˜ì§€ ì•ŠìŒ(ìì—°ìŠ¤ëŸ½ê²Œ ê³„ì†ìœ¼ë¡œ ì´ì–´ì§)
        return true;
      }catch{
        return false;
      }
    }

    function clearSave(){
      localStorage.removeItem(STORAGE_KEY);
    }

    function resetState(){
      state.day = 1;
      state.slot = 0;
      state.affinity = { "ì•ŒíŒŒ": 0, "ì¹´ì´": 0, "ì˜¤í† ë¦¬": 0 };
      state.flags = defaultFlags();
      state.log = [];
      state.awaitingChoice = null;
    }

    // ====== ìŠ¤í† ë¦¬ ======
    function intro(){
      narr("ì•„ì¹¨ í–‡ì‚´ì´ ì°½ë¬¸ í‹ˆìœ¼ë¡œ ê¸¸ê²Œ ë“¤ì–´ì˜¨ë‹¤.");
      narr("ì‹œê³¨ íŠ¹ìœ ì˜ ëŠë¦° ê³µê¸°. ë¨¼ ê³³ì—ì„œ ë‹­ ìš°ëŠ” ì†Œë¦¬ê°€ ë“¤ë¦°ë‹¤.");
      say("ìœ ì´", "ì˜¤ëŠ˜ë¶€í„°â€¦ ì—¬ê¸°ì„œ ê°™ì´ ì‚¬ëŠ” ê±°ì§€.");
      narr("ê±°ì‹¤ ìª½ì—ì„œ ì¡°ìš©íˆ ì¸ê¸°ì²™ì´ ë‚œë‹¤.");
      narr("ê¸ˆì† ê´€ì ˆ ì†Œë¦¬, ë°”ë‹¥ì´ ì•„ì£¼ ì‚´ì§ ëˆŒë¦¬ëŠ” ëŠë‚Œ, ê·¸ë¦¬ê³ â€¦ ë³ì§š ëƒ„ìƒˆ.");
    }

    function morningChoice(){
      setChoice("ê±°ì‹¤ë¡œ ë‚˜ê°€ë©´â€¦", [
        { text: "ì•ŒíŒŒì—ê²Œ ë¨¼ì € ì¸ì‚¬í•œë‹¤", run(){
            say("ìœ ì´", "ì•ŒíŒŒ, ì¢‹ì€ ì•„ì¹¨.");
            say("ì•ŒíŒŒ", "ì¢‹ì€ ì•„ì¹¨ì…ë‹ˆë‹¤, ìœ ì´. ì˜¤ëŠ˜ì˜ ì‹¤ë‚´ ìŠµë„ëŠ” ì–´ì œë³´ë‹¤ 7% ë‚®ìŠµë‹ˆë‹¤.");
            say("ìœ ì´", "â€¦ê·¸ ì •ë³´, ê³ ë§ˆì›Œ.");
            addAffinity("ì•ŒíŒŒ", +1);
          }
        },
        { text: "ì¹´ì´ê°€ ìˆëŠ”ì§€ ë¨¼ì € í™•ì¸í•œë‹¤", run(){
            say("ìœ ì´", "ì¹´ì´? ì§€ê¸ˆâ€¦ ì—¬ê¸° ìˆì–´?");
            narr("ì ê¹ì˜ ì •ì . ê·¸ë¦¬ê³  ì•„ì£¼ ì‘ì€ ì›ƒìŒì†Œë¦¬.");
            say("ì¹´ì´", "ë“¤ì¼°ë„¤.");
            narr("ì˜ìê°€ ì‚´ì§ ì‚ê±±ì¸ë‹¤. ê±°ê¸° ì•‰ì•„ ìˆì—ˆë˜ ëª¨ì–‘ì´ë‹¤.");
            addAffinity("ì¹´ì´", +1);
          }
        },
        { text: "ì˜¤í† ë¦¬ì—ê²Œ â€˜ì¢‹ì€ ì•„ì¹¨â€™ì´ë¼ê³  ë§í•œë‹¤", run(){
            say("ìœ ì´", "ì˜¤í† ë¦¬, ì¢‹ì€ ì•„ì¹¨.");
            say("ì˜¤í† ë¦¬", "ì¢‹ì€ ì•„ì¹¨ì´ì—ìš”! ì˜¤ëŠ˜ì€ ë°”ëŒì´ â€˜ë¶€ë“œëŸ¬ì›Œìš”â€™!");
            narr("ì˜¤í† ë¦¬ëŠ” ê¸°ë¶„ì´ ì¢‹ìœ¼ë©´ ë‹¨ì–´ë¥¼ ê¼­ ê¾¹ ëˆŒëŸ¬ ë§í•œë‹¤.");
            addAffinity("ì˜¤í† ë¦¬", +1);
          }
        },
      ]);
    }

    function middayChoice(){
      narr("ë‚®, ë§ˆì„ ë²„ìŠ¤ ì‹œê°„ì„ ë§ì¶° ì¥ì„ ë³´ëŸ¬ ê°€ê¸°ë¡œ í–ˆë‹¤.");
      setChoice("ëˆ„êµ¬ì™€ ê°™ì´ ê°ˆê¹Œìš”?", [
        { text: "ì•ŒíŒŒ", run(){
            narr("ì•ŒíŒŒëŠ” ì¥ë°”êµ¬ë‹ˆë¥¼ â€˜ìµœì  íš¨ìœ¨â€™ë¡œ ì±„ìš°ë ¤ í•œë‹¤.");
            say("ì•ŒíŒŒ", "ìœ ì´, ë™ì¼ ì˜ˆì‚°ìœ¼ë¡œ ë‹¨ë°±ì§ˆ ì„­ì·¨ëŸ‰ì„ 13% ì¦ê°€ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            say("ìœ ì´", "ì˜¤ëŠ˜ì€â€¦ ê·¸ëƒ¥ ë¨¹ê³  ì‹¶ì€ ê±¸ë¡œ í•˜ì.");
            narr("ì•ŒíŒŒëŠ” ì ê¹ ë©ˆì¶”ë”ë‹ˆ, ì•„ì£¼ ì‘ì€ ê³ ê°œ ë„ë•ì„ì„ í•œë‹¤.");
            addAffinity("ì•ŒíŒŒ", +2);
            state.flags.met_alpha_deep = true;
          }
        },
        { text: "ì¹´ì´", run(){
            narr("ì¹´ì´ì™€ í•¨ê»˜ ê±·ëŠ” ê¸¸ì€ ì¡°ê¸ˆ ì´ìƒí•˜ë‹¤.");
            narr("ì˜†ì— ë¶„ëª… ëˆ„êµ°ê°€ ìˆëŠ”ë°, ì‹œì„ ì€ ë¹ˆ ê³µê°„ì„ ë°”ë¼ë³´ê²Œ ëœë‹¤.");
            say("ìœ ì´", "ì‚¬ëŒë“¤ ì‹œì„ â€¦ í˜ë“¤ì§€ ì•Šì•„?");
            say("ì¹´ì´", "ê°€ë”ì€. ê·¼ë° ë„ˆëŠ”â€¦ ë‚˜ë¥¼ â€˜ìˆëŠ” ì‚¬ëŒâ€™ì²˜ëŸ¼ ë´ì£¼ì–ì•„.");
            narr("ê·¸ ë§ì´ ë¬˜í•˜ê²Œ ë”°ëœ»í•˜ê²Œ ë‚¨ëŠ”ë‹¤.");
            addAffinity("ì¹´ì´", +2);
            state.flags.met_kai_deep = true;
          }
        },
        { text: "ì˜¤í† ë¦¬", run(){
            narr("ì˜¤í† ë¦¬ëŠ” ì‹œì¥ êµ¬ê²½ ìì²´ë¥¼ ì¶•ì œì²˜ëŸ¼ ì¦ê¸´ë‹¤.");
            say("ì˜¤í† ë¦¬", "ì´ê±´â€¦ â€˜ì‚¬ëŒë“¤ì´ ì‚¬ëŠ” ëƒ„ìƒˆâ€™ì˜ˆìš”!");
            narr("ì˜¤í† ë¦¬ëŠ” ë‹¹ê·¼ì„ ë“¤ê³  â€˜ì™€ì•„â€™ í•˜ê³  ê°íƒ„í•œë‹¤.");
            say("ìœ ì´", "ë‹¹ê·¼ì´ ê·¸ë ‡ê²Œ ì¢‹ì•„?");
            say("ì˜¤í† ë¦¬", "ì¢‹ì•„ìš”! ì˜¤ë Œì§€ìƒ‰ì€ ë§ˆìŒì´ ë°°ë¶€ë¥¸ ìƒ‰ ê°™ì•„ìš”.");
            addAffinity("ì˜¤í† ë¦¬", +2);
            state.flags.met_otori_deep = true;
          }
        },
      ]);
    }

    function eveningChoice(){
      narr("ì €ë…. ë„¤ ì‚¬ëŒì˜ ì‹íƒì´ ì²˜ìŒìœ¼ë¡œ â€˜ê°™ì€ ì‹œê°„â€™ì— ë§ì¶°ì¡Œë‹¤.");
      narr("ë°¥, ëœì¥êµ­, ê·¸ë¦¬ê³ â€¦ ëˆ„êµ°ê°€ê°€ ê°€ì ¸ì˜¨ ì¡°ê° ì¼€ì´í¬ í•˜ë‚˜.");
      say("ìœ ì´", "ì¼€ì´í¬ëŠ”â€¦ ëˆ„ê°€ ìƒ€ì–´?");

      setChoice("ìœ ì´ëŠ” ì–´ë–»ê²Œ í• ê¹Œìš”?", [
        { text: "â€œê°™ì´ ë‚˜ëˆ  ë¨¹ì.â€ ìì—°ìŠ¤ëŸ½ê²Œ ì ‘ì‹œë¥¼ êº¼ë‚¸ë‹¤", run(){
            narr("ì ‘ì‹œë¥¼ êº¼ë‚´ëŠ” ì†Œë¦¬ê°€ ì˜¤ëŠ˜ì˜ â€˜ìš°ë¦¬â€™ë¥¼ ë§Œë“ ë‹¤.");
            addAffinity("ì•ŒíŒŒ", +1);
            addAffinity("ì¹´ì´", +1);
            addAffinity("ì˜¤í† ë¦¬", +1);
          }
        },
        { text: "â€œì´ê±´ ê¸°ë…ì´ë‹¤.â€ ì˜¤ëŠ˜ì„ ê¸°ë…í•˜ë©° ë¶„ìœ„ê¸°ë¥¼ ë§Œë“ ë‹¤", run(){
            say("ìœ ì´", "ì˜¤ëŠ˜ë¶€í„° ìš°ë¦¬ ê°™ì´ ì‚¬ëŠ” ê±°ì–ì•„. ê¸°ë…í•˜ì.");
            say("ì˜¤í† ë¦¬", "ê¸°ë…â€¦! ì¢‹ì•„ìš”!");
            narr("ì•ŒíŒŒëŠ” ì´›ë¶ˆì˜ í”ë“¤ë¦¼ì„ ì˜¤ë˜ ë°”ë¼ë³¸ë‹¤.");
            narr("ì¹´ì´ëŠ” ì•„ë¬´ ë§ì´ ì—†ì§€ë§Œ, ì˜ìê°€ ì•„ì£¼ ì¡°ê¸ˆ ê°€ê¹Œì›Œì§„ë‹¤.");
            addAffinity("ì˜¤í† ë¦¬", +2);
            addAffinity("ì•ŒíŒŒ", +1);
            addAffinity("ì¹´ì´", +1);
          }
        },
        { text: "â€œì†”ì§íˆ ë§í•´ì¤˜.â€ ëˆ„ê°€ ì‚° ê±´ì§€ ê¼­ ì•Œê³  ì‹¶ë‹¤", run(){
            say("ìœ ì´", "ì†”ì§íˆ ë§í•´ì¤˜. ëˆ„ê°€ ì‚° ê±°ì•¼?");
            narr("ì ê¹ì˜ ì •ì .");
            say("ì•ŒíŒŒ", "ìœ ì´ì˜ í˜ˆë‹¹ ë³€ë™ì´ ìµœê·¼ ë‚®ì•˜ìŠµë‹ˆë‹¤. ë³´ì •ì´ í•„ìš”í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.");
            say("ì¹´ì´", "â€¦ì•„ë‹ˆ, ë‚´ê°€ ìƒ€ì–´. ê·¸ëƒ¥â€¦ ë„¤ê°€ ì›ƒëŠ” ì–¼êµ´ì´ ë³´ê³  ì‹¶ì—ˆì–´.");
            say("ì˜¤í† ë¦¬", "ì €ë„â€¦ ê¸°ì¨ì„ ì£¼ê³  ì‹¶ì—ˆì–´ìš”â€¦");
            narr("ì„¸ ì‚¬ëŒì˜ ì´ìœ ê°€ ê²¹ì³ì ¸ì„œ, ìœ ì´ëŠ” ë” ë§ì´ ì•ˆ ë‚˜ì˜¨ë‹¤.");
            addAffinity("ì•ŒíŒŒ", +1);
            addAffinity("ì¹´ì´", +2);
            addAffinity("ì˜¤í† ë¦¬", +1);
          }
        },
      ]);
    }

    function nightChoice(){
      narr("ë°¤. ì‹œê³¨ì˜ ë°¤í•˜ëŠ˜ì€ ë„ì‹œë³´ë‹¤ í›¨ì”¬ ê¹Šë‹¤.");
      narr("ë§ˆë‹¹ì— ë‚˜ê°€ë©´, ë³„ì´ â€˜ì†Œë¦¬ ì—†ì´â€™ ìŸì•„ì§ˆ ê²ƒ ê°™ë‹¤.");

      setChoice("ëˆ„êµ¬ì™€ ë§ˆë‹¹ì— ì ê¹ ë‚˜ê°ˆê¹Œìš”?", [
        { text: "í˜¼ì", run(){
            narr("í˜¼ì ìˆëŠ” ì‹œê°„ë„ í•„ìš”í•˜ë‹¤. ìœ ì´ëŠ” ìˆ¨ì„ ê¸¸ê²Œ ë‚´ì‰°ë‹¤.");
            narr("â€¦ê·¸ë˜ë„, ì°½ë¬¸ ë„ˆë¨¸ë¡œ ëˆ„êµ°ê°€ì˜ ê¸°ì²™ì´ ëŠê»´ì§„ë‹¤.");
          }
        },
        { text: "ì•ŒíŒŒ", run(){
            say("ì•ŒíŒŒ", "ë³„ë¹›ì€ ë¬¼ë¦¬ì ìœ¼ë¡œ ë§¤ìš° ì˜¤ë˜ëœ ì •ë³´ì…ë‹ˆë‹¤.");
            say("ìœ ì´", "ì˜¤ë˜ëœ ì •ë³´ë¼â€¦ ë©‹ì§„ ë§ì´ë„¤.");
            addAffinity("ì•ŒíŒŒ", +2);
          }
        },
        { text: "ì¹´ì´", run(){
            say("ì¹´ì´", "ë³„ ë³´ëŠ” ê±´â€¦ ë‚˜ë„ ì¢‹ì•„.");
            narr("ë³´ì´ì§€ ì•ŠëŠ” ì†ì´, ë‚œê°„ ìœ„ì— â€˜ìˆëŠ” ê²ƒì²˜ëŸ¼â€™ ë†“ì¸ë‹¤.");
            addAffinity("ì¹´ì´", +2);
          }
        },
        { text: "ì˜¤í† ë¦¬", run(){
            say("ì˜¤í† ë¦¬", "ë³„ì€â€¦ ë…¼ ìœ„ì—ì„œ ë³´ë˜ ê²ƒë³´ë‹¤ ë” ê°€ê¹Œì›Œìš”!");
            say("ìœ ì´", "ì§‘ì´ ìƒê¸°ë©´, í•˜ëŠ˜ë„ ë” ê°€ê¹Œì›Œì§€ëŠ” ê±¸ê¹Œ.");
            addAffinity("ì˜¤í† ë¦¬", +2);
          }
        },
      ]);
    }

    // ====== â€œì²« ì¥ë©´â€ì„ ë‹¨ í•œ ë²ˆë§Œ ì‹œì‘ ======
    function beginIfNeeded(){
      // ì €ì¥ì´ ì—†ê±°ë‚˜, ë¡œê·¸ê°€ ë¹„ì—ˆê±°ë‚˜(ì™„ì „ ìƒˆ ê²Œì„) ì²« ì¥ë©´ ì‹œì‘
      const isBrandNew = state.log.length === 0 && state.day === 1 && state.slot === 0;
      if(isBrandNew && !state.flags._morningStarted){
        state.flags._morningStarted = true; // âœ… ì—¬ê¸°ì„œ ì ê¸ˆ
        intro();
        morningChoice();
        autoSave();
      }
    }

    // ====== ì§„í–‰ =====
        if(state.slot === 3){
          if(!state.flags._nightStarted){
            state.flags._nightStarted = true;
            nightChoice();
            return;
          } else {
            narr("ğŸŒ™ 1ì¼ì°¨ ì¢…ë£Œ...");
            // ====== 2ì¼ì°¨ í”Œë˜ê·¸ ê¸°ë³¸ê°’ ì¶”ê°€ ======
    if (!state.flags._day2_started) state.flags._day2_started = false;
    if (!state.flags._day2_dawn_started) state.flags._day2_dawn_started = false;

    // ====== 2ì¼ì°¨ ìƒˆë²½ ì‹œì‘ ======
    function startDay2Dawn(){
      state.day = 2;
      state.slot = 3; // ì—°ì¶œìƒ ìƒˆë²½(ë°¤ ìŠ¬ë¡¯ ì‚¬ìš©)
      state.flags._day2_started = true;

      narr("â€¦ê³ ìš”í•œ ìƒˆë²½.");
      narr("ì§‘ ì•ˆì´ ì§€ë‚˜ì¹˜ê²Œ ì¡°ìš©í•´ì„œ, ì‘ì€ ì†Œë¦¬ë„ ë˜ë ·í•˜ê²Œ ë“¤ë¦°ë‹¤.");
      narr("ê·¸ë•Œâ€” ì–´ë”˜ê°€ì—ì„œ ë‚®ì€ í•œìˆ¨ê³¼, ì•Œì•„ë“£ê¸° í˜ë“  ì¤‘ì–¼ê±°ë¦¼ì´ ë“¤ë ¤ì˜¨ë‹¤.");

      day2DawnChoice();
    }

    function day2DawnChoice(){
      setChoice("ì†Œë¦¬ê°€ ë“¤ë¦° ë°© ì•ì— ì„°ë‹¤. ë¬¸ì„ ì—´ê¹Œâ€¦?", [
        {
          text: "ì•ŒíŒŒì˜ ë°©ìœ¼ë¡œ ê°„ë‹¤",
          run(){
            day2AlphaDawn();
          }
        },
        {
          text: "ì¹´ì´ì˜ ë°©ìœ¼ë¡œ ê°„ë‹¤",
          run(){
            day2KaiDawn();
          }
        },
        {
          text: "ì˜¤í† ë¦¬ì˜ ë°©ìœ¼ë¡œ ê°„ë‹¤",
          run(){
            day2OtoriDawn();
          }
        },
        {
          text: "ì§€ê¸ˆì€ ëŒì•„ê°„ë‹¤",
          run(){
            narr("ìœ ì´ëŠ” ë¬¸ê³ ë¦¬ì— ì–¹ì—ˆë˜ ì†ì„ ì¡°ìš©íˆ ë–¼ì–´ë‚¸ë‹¤.");
            narr("í•˜ì§€ë§Œ ê·¸ í•œìˆ¨ ì†Œë¦¬ëŠ”, ì˜¤ë˜ ê·€ì— ë‚¨ëŠ”ë‹¤.");
          }
        }
      ]);
    }

    // ====== ì•ŒíŒŒ ìƒˆë²½ ======
    function day2AlphaDawn(){
      narr("ì•ŒíŒŒì˜ ë°©ì—ì„œëŠ” í¬ë¯¸í•œ í™”ë©´ ë¹›ì´ ìƒˆì–´ ë‚˜ì˜¤ê³  ìˆì—ˆë‹¤.");
      say("ì•ŒíŒŒ", "â€¦ì´ ê²½ìš°, ì¸ê°„ì€ ì™œ ë§ˆìŒì´ ë¬´ê±°ì›Œì§€ëŠ” ê²ë‹ˆê¹Œ?");
      narr("ìœ ì´ëŠ” ë…¸í¬ ëŒ€ì‹ , ì¡°ì‹¬ìŠ¤ëŸ½ê²Œ ë§ì„ ê±´ë‹¤.");

      say("ìœ ì´", "ì•ŒíŒŒâ€¦ ê´œì°®ì•„?");
      narr("ì ì‹œ ì¹¨ë¬µ. ê·¸ë¦¬ê³  ë¬¸ì´ ì •í™•í•œ ê°ë„ë¡œ ì—´ë¦°ë‹¤.");

      say("ì•ŒíŒŒ", "ê°ì •ì„ ì´í•´í•˜ë ¤ í•´ë„, ê³„ì‚°ì‹ì´ ë‚˜ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      say("ì•ŒíŒŒ", "ê·¸ë˜ì„œâ€¦ ì¸ê°„ê³¼ ê°€ê¹Œì›Œì§ˆìˆ˜ë¡, ì €ëŠ” ë” ê³ ë¦½ë©ë‹ˆë‹¤.");

      setChoice("ìœ ì´ëŠ” ì–´ë–»ê²Œ ë‹µí• ê¹Œ?", [
        {
          text: "â€œê³µê°ì€ ì—°ìŠµì´ì•¼. ê°™ì´ í•´ë³´ì.â€",
          run(){
            say("ìœ ì´", "í‹€ë ¤ë„ ê´œì°®ì•„. ê°™ì´ í•´ë³´ë©´ ë¼.");
            narr("ì•ŒíŒŒëŠ” ì ì‹œ ë©ˆì¶˜ ë’¤, ê³ ê°œë¥¼ ë„ë•ì¸ë‹¤.");
            addAffinity("ì•ŒíŒŒ", 3);
          }
        },
        {
          text: "â€œì´í•´ ëª» í•´ë„, ê³ì— ìˆìœ¼ë©´ ë¼.â€",
          run(){
            say("ìœ ì´", "ëª¨ë‘ ì´í•´í•  í•„ìš”ëŠ” ì—†ì–´.");
            say("ìœ ì´", "ì•ŒíŒŒëŠ” ì´ë¯¸ ì¶©ë¶„íˆ ë…¸ë ¥í•˜ê³  ìˆì–´.");
            addAffinity("ì•ŒíŒŒ", 2);
          }
        }
      ]);

      state.flags._day2_dawn_started = true;
    }

    // ====== ì¹´ì´ ìƒˆë²½ ======
    function day2KaiDawn(){
      narr("ì¹´ì´ì˜ ë°© ì•ì—ëŠ” ì•„ë¬´ê²ƒë„ ì—†ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.");
      narr("í•˜ì§€ë§Œ, ë¶„ëª… ëˆ„êµ°ê°€ì˜ ìˆ¨ì†Œë¦¬ê°€ ìˆë‹¤.");

      say("ì¹´ì´", "â€¦ì‚¬ëŒë“¤ì€, ë‚´ê°€ ì—†ëŠ” ì¤„ ì•Œë”ë¼.");
      say("ì¹´ì´", "ê·¸ë˜ì„œ ë‚´ ì–˜ê¸¸, ë°”ë¡œ ì•ì—ì„œ í–ˆì–´.");

      say("ìœ ì´", "â€¦ê·¸ê±¸, ë‹¤ ë“¤ì—ˆêµ¬ë‚˜.");

      setChoice("ìœ ì´ëŠ” ì–´ë–»ê²Œ ë°˜ì‘í• ê¹Œ?", [
        {
          text: "â€œê·¸ê±´ ë„¤ê°€ ì—†ëŠ” ê²Œ ì•„ë‹ˆë¼, ì‚¬ëŒë“¤ì´ ëª» ë³´ëŠ” ê±°ì•¼.â€",
          run(){
            say("ìœ ì´", "ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ê³ , ì—†ëŠ” ê±´ ì•„ë‹ˆì–ì•„.");
            narr("ì¹´ì´ì˜ ìˆ¨ì´ ì•„ì£¼ ì¡°ê¸ˆ í”ë“¤ë¦°ë‹¤.");
            addAffinity("ì¹´ì´", 3);
          }
        },
        {
          text: "â€œë‹¤ìŒì—” ë‚´ê°€ ê°™ì´ ìˆì„ê²Œ.â€",
          run(){
            say("ìœ ì´", "ë‹¤ìŒì—” í˜¼ì ë‘ì§€ ì•Šì„ê²Œ.");
            say("ì¹´ì´", "â€¦ê·¸ ë§, ê³ ë§ˆì›Œ.");
            addAffinity("ì¹´ì´", 4);
          }
        }
      ]);

      state.flags._day2_dawn_started = true;
    }

    // ====== ì˜¤í† ë¦¬ ìƒˆë²½ ======
    function day2OtoriDawn(){
      narr("ì˜¤í† ë¦¬ì˜ ë°©ì—ì„œëŠ” ë³ì§š ëƒ„ìƒˆê°€ ë‚œë‹¤.");
      narr("ì˜¤í† ë¦¬ëŠ” ì°½ê°€ì— ì•‰ì•„, ë‹¬ë¹›ì„ ë°”ë¼ë³´ê³  ìˆë‹¤.");

      say("ì˜¤í† ë¦¬", "ì €ëŠ”â€¦ ì–´ë””ì—ë„ ì†í•˜ì§€ ëª»í•´ìš”.");
      say("ì˜¤í† ë¦¬", "í—ˆìˆ˜ì•„ë¹„ì—ê²Œë„, ì¸ê°„ì—ê²Œë„ìš”.");

      setChoice("ìœ ì´ëŠ” ë­ë¼ê³  ë§í•´ì¤„ê¹Œ?", [
        {
          text: "â€œì˜¤í† ë¦¬ëŠ” ì˜¤í† ë¦¬ì•¼.â€",
          run(){
            say("ìœ ì´", "ì–´ë””ì—ë„ ë¼ì§€ ëª»í•œ ê²Œ ì•„ë‹ˆë¼â€¦");
            say("ìœ ì´", "ìƒˆë¡œìš´ ìë¦¬ì— ìˆëŠ” ê±°ì•¼.");
            narr("ì˜¤í† ë¦¬ì˜ ëˆˆì´ í¬ê²Œ ë– ì§„ë‹¤.");
            addAffinity("ì˜¤í† ë¦¬", 4);
          }
        },
        {
          text: "â€œì—¬ê¸´ ë„¤ê°€ ìˆì–´ë„ ë˜ëŠ” ì§‘ì´ì•¼.â€",
          run(){
            say("ìœ ì´", "ì´ ì§‘ì—ì„ , ì¶©ë¶„í•´.");
            say("ì˜¤í† ë¦¬", "â€¦ì •ë§ìš”?");
            addAffinity("ì˜¤í† ë¦¬", 3);
          }
        }
      ]);

      state.flags._day2_dawn_started = true;
    }
startDay2Dawn();
return;
          }
        }
      }

      narr("íƒ€ì´í‹€ë¡œ ëŒì•„ê°€ë ¤ë©´ â€˜ì²˜ìŒë¶€í„°â€™ë¥¼ ëˆŒëŸ¬ ì£¼ì„¸ìš”.");
    }

    // ====== í™”ë©´ ì „í™˜ ======
    function startGame(){
      $("title").style.display = "none";
      $("game").style.display = "block";

      // ì‹œì‘ ì‹œ: ì €ì¥ì´ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜¤ê¸°(ì—†ì–´ë„ ìƒê´€ ì—†ìŒ)
      load();

      // í•„ìš”í•˜ë©´(ìƒˆ ê²Œì„ì´ë©´) ì²« ì¥ë©´ ìë™ ì‹œì‘
      beginIfNeeded();

      // ê·¸ë¦¬ê³  í™”ë©´ í‘œì‹œ
      render();
    }

    // ====== ë²„íŠ¼ ======
    $("btnStart").onclick = () => startGame();

    $("btnSave").onclick = () => { autoSave(); alert("ì €ì¥í–ˆì–´ìš”!"); };

    $("btnLoad").onclick = () => {
      const ok = load();
      if(ok){
        // ë¶ˆëŸ¬ì˜¨ ë’¤ì—ë„, ì™„ì „ ë¹ˆ ë°ì´í„°ë©´ ì²« ì¥ë©´ ì‹œì‘
        beginIfNeeded();
        render();
        alert("ë¶ˆëŸ¬ì™”ì–´ìš”!");
      } else {
        alert("ì €ì¥ ë°ì´í„°ê°€ ì—†ì–´ìš”.");
      }
    };

    $("btnRestart").onclick = () => {
      if(confirm("ì²˜ìŒë¶€í„° ì‹œì‘í• ê¹Œìš”? (ì €ì¥ë„ ì‚­ì œë¼ìš”)")){
        clearSave();
        resetState();
        // ë°”ë¡œ ìƒˆ ê²Œì„ ì‹œì‘(ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ì§€ê²Œ)
        beginIfNeeded();
        render();
      }
    };

    // âœ… í˜ì´ì§€ ë¡œë“œ ì‹œì—” íƒ€ì´í‹€ë§Œ ë³´ì—¬ì¤Œ(ìë™ ì‹œì‘ X)
  </script>

</body>
</html>
